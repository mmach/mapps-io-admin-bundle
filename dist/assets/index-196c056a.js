import{R as o,t as P,f as U,y as j,z as O,M as b,A as B,u as V,j as a,G as m,T as d,D as x,F as z,C as G,H as Y}from"./index-96500733.js";function H({asAdmin:p,tableConfig:u,withDate:s=!0,openIuaCms:I="DEFAULT"}){const[g,l]=o.useState(!0),[c,F]=o.useState(new Date),[f,S]=o.useState([]),y=u||G,v=P({}),L=U(),M=j(),h=O(),_=o.useMemo(b().Layouts.Table.V2),A=o.useMemo(b().IUA.PREVIEW.DEFAULT),r=B(),{translate:C,getLabel:w}=V();o.useEffect(()=>()=>r.actions.clean(),[]),o.useEffect(()=>{l(!0),r.actions.getInvoices({year:s?c.getFullYear():void 0,month:s?c.getMonth():void 0,size:s?100:1e5,page:0,asAdmin:p}).then(e=>{const t=e.data.filter(n=>!v.selectors.iuaReducer.iuaRelations[n.iua.id]).map(n=>n.iua.id);if(l(!1),t.length>0)return v.actions.getIuaList(t)}).then(e=>{if(e&&e.data){const t=[...new Set(e.data.map(n=>n.category_id))];h.hooks.setCategoryIds(t)}})},[c]),o.useEffect(()=>{S([...r.selectors.InvoicesReducer.invoices])},[r.selectors.InvoicesReducer.invoices]);function D(e){const t=e;window.scrollTo(0,0),F(t)}function E(e,t){console.log(t),M.actions.openDrawer(!0,a(m,{container:!0,style:{width:1100},children:a(A,{iua_id:t.iua.parent_iua_id,cmsMode:I,device:"desktop"})}),"right")}function R(e,t){const n=t.id,i=f.filter(k=>k.id==n)[0],T={pdf_id:i.blob.blob_id,subject:C(w,"SEND_MAIL_SUBJECT",i.number_string,i.month+"/"+i.year),body:`${window.env.BLOB_URL}/blob/${i.blob.blob_id}.pdf`};L.actions.openModal(!0,a(Y,{...T}))}return a(m,{container:!0,style:{justifyContent:"center"},children:a(_,{isLoading:g,icons:d,freeActions:[s?a(x,{variant:"month",label:"Month",dateFormat:"MM/yyyy",showMonthYearPicker:!0,value:c,onChange:D}):a(z,{})],...y({}),actions:[()=>({icon:d.OpenIn,label:"Open IUA",onClick:E}),()=>({icon:d.PictureAsPdf,label:"Open Invoice",onClick:R})],data:f.sort((e,t)=>new Date(t.createdAt)>new Date(e.createdAt)?1:-1).map(e=>({...e,info:{number:e.number}})),title:"Invoices List"})})}export{H as default};
