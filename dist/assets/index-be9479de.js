import{cU as O,cV as h,r as c,v as S,cW as p,cX as w,cY as y,R as r,M as s,u as R,c$ as T,g as Y,G,j as a,cZ as q,eh as z,d1 as $,T as D}from"./index-b2bea69e.js";import{p as H}from"./index-eb8c6a19.js";const u=t=>{const i={upsertPriv:e=>t(new p().commandThunt(w.Privileges.UPSERT_PRIV,e)),deletePriv:e=>t(new p().commandThunt(w.Privileges.DELETE_PRIV,e)),deletePrivGlobal:e=>t(new p().commandThunt(w.Privileges.DELETE_PRIV_GLOBALLY,e)),upsertPrivGlobal:e=>t(new p().commandThunt(w.Privileges.UPSERT_PRIV_GLOBALLY,e)),get:e=>t(new p().queryThunt(y.Privileges.GET_PRIVS,e)),getAll:e=>t(new p().queryThunt(y.Privileges.GET_GLOBAL_PRIVS,e))};return{...i,upsertPriv:async e=>{await i.upsertPriv(e),await i.get()},deletePriv:async e=>{await i.deletePriv(e),await i.get()},upsertPrivGlobal:async e=>{await i.upsertPrivGlobal(e),await i.upsertPriv({privilege_id:e.id,id:S(),status:!0}),await i.getAll(),await i.get()},deletePrivGlobal:async e=>{await i.deletePrivGlobal(e),await i.getAll(),await i.get()}}},N=()=>t=>t.PrivilegesAdminReducer.privilegesGlobal,Q=()=>t=>t.PrivilegesAdminReducer.privileges;function k(){const t=O(),{privilegesAdminReducer:i}=h(m=>({privilegesAdminReducer:m.PrivilegesAdminReducer})),e=h(N()),b=h(Q()),d=c.useCallback(u(t).getAll,[t]),v=c.useCallback(u(t).get,[t]),f=c.useCallback(u(t).upsertPrivGlobal,[t]),n=c.useCallback(u(t).deleteAction,[t]),g=c.useCallback(u(t).deletePrivGlobal,[t]),A=c.useCallback(u(t).deletePriv,[t]),P=c.useCallback(u(t).upsertPriv,[t]);return{selectors:{privilegesAdminReducer:i,getAllPrivilegesGlobalReducer:e,getAllPrivilegesReducer:b},actions:{upsertPriv:P,deletePriv:A,deletePrivGlobal:g,deleteAction:n,upsertPrivGlobal:f,getAll:d,get:v},state:{},hooks:{},functions:{}}}function W({}){const t=r.useMemo(s().Layouts.Sections.V1);r.useMemo(s().FormComponents.DropDownList);const i=r.useMemo(s().FormComponents.TextBox);r.useMemo(s().FormComponents.TextArea),r.useMemo(s().FormComponents.Checkbox);const e=r.useMemo(s().ButtonLoader),{selectors:{},actions:{upsertPrivGlobal:b}}=k(),{translate:d,getLabel:v}=R(),f=T(),[n,g]=r.useState({id:S()}),[A,P]=r.useState(!1);function m(){P(!0),b({...n,id:n.id}).then(C=>{P(!1),f.actions.closeDrawer()})}return Y(G,{container:!0,children:[a(t,{title:"Action Details",style:{flexDirection:"column"},children:a(i,{label:d(v,"Name"),value:n.name,onChange:C=>g({...n,name:C.target.value.toUpperCase()}),field:"value",validation:[]})}),a(G,{style:{marginLeft:"1rem",marginBottom:"1rem"},children:a(e,{color:"primary",onClick:m,value:d(v,"Save"),variant:"outlined",isLoading:A})})]})}function K(t){const[i,e]=r.useState(!0),b=r.useMemo(s().Layouts.Containers.V1),d=r.useMemo(s().Layouts.Table.V2),v=r.useMemo(s().ButtonLoader),f=r.useMemo(s().ConfirmationDialog),{actions:n}=T(),g=q(),{translate:A,getLabel:P}=R(),{selectors:{getAllPrivilegesGlobalReducer:m,getAllPrivilegesReducer:C},actions:{get:M,getAll:_,upsertPriv:x,deletePriv:E,deletePrivGlobal:j}}=k(),B=r.useMemo(()=>m.sort((l,o)=>o.name<l.name?1:-1).map(l=>{const o=C.find(L=>L.privilege_id==l.id);return{...l,privilegesProject:o}}),[m,C]);r.useEffect(()=>{e(!0),Promise.all([_(),M()]).then(l=>{e(!1)})},[]);function F(l,o){const L=S();e(!0),x({id:L,privilege_id:o.id,status:!0}).then(X=>{e(!1)})}function V(l,o){e(!0),E({id:o.privilegesProject.id}).then(L=>{e(!1)})}function I(){n.openDrawer(!0,a(G,{style:{width:"50vw",display:"flex"},children:a(W,{})}),"right")}function U(l,o){g.actions.openDialog(!0,a(f,{title:"Delete Privilege",description:"Do you want to delete this privilege?",onConfirm:async()=>{g.actions.closeDialog(),e(!0),await j(o),e(!1)}}))}return a(G,{container:!0,style:{justifyContent:"center"},children:a(b,{title:"Privileges",icon:a(z,{}),xs:12,sm:12,children:a(d,{isLoading:i,title:"Manage Privileges",...H({}),freeActions:[a(v,{size:"small",value:A(P,"Add Privilege"),variant:"outlined",onClick:I,startIcon:a($,{})},1)],pageSize:20,actions:[l=>({icon:D.Check,label:"Activate Privilege",onClick:F,hidden:l.privilegesProject}),l=>({icon:D.Clear,label:"Deactive Privilege",onClick:V,hidden:!l.privilegesProject}),l=>({icon:D.Delete,label:"Delete Privilege",onClick:U,hidden:!l.project_id||l.privilegesProject})],data:B})})})}export{K as default};
