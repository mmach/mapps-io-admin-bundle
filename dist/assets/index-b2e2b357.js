import{cS as U,cT as M,r as v,cU as y,cW as R,cV as E,R as a,M as i,u as _,cZ as j,v as G,g as P,G as d,j as s,m as F,d0 as V,c$ as I,T as B}from"./index-b4b9f8f0.js";const q=({})=>({columns:[{titleToken:"CREATED AT",field:"createdAt",type:"date",isActive:!0},{titleToken:"STATUS",field:"token",isActive:!0},{titleToken:"ACTIVATED",type:"checkbox",field:"statusProject",isActive:!0},{titleToken:"PREDEFINED",type:"!checkbox",field:"project_id",isActive:!0}],detailPanelPlugin:"mapps-status-expanded-preview"}),L=t=>{const n={getStatuses:e=>t(new y().queryThunt(R.Status.GET_GLOBAL_STATUSES,e)),getStatusesProject:e=>t(new y().queryThunt(R.Status.GET_STATUS,e)),upsertStatus:e=>t(new y().commandThunt(E.Status.UPSERT_STATUS,e)),upsertStatusGlobal:e=>t(new y().queryThunt(E.Status.UPSERT_STATUS_GLOBAL,e))};return{...n,upsertStatusGlobal:async e=>{await n.upsertStatusGlobal(e),await n.getStatuses()},upsertStatus:async e=>{await n.upsertStatus(e),await n.getStatusesProject()}}},O=()=>t=>t.StatusAdminReducer.statusesGlobal,z=()=>t=>t.StatusAdminReducer.statuses;function D(){const t=U(),{statusAdminReducer:n}=M(c=>({statusAdminReducer:c.StatusAdminReducer})),e=M(O()),g=M(z()),S=v.useCallback(L(t).getStatuses,[t]),p=v.useCallback(L(t).getStatusesProject,[t]),f=v.useCallback(L(t).upsertStatus,[t]),u=v.useCallback(L(t).upsertStatusGlobal,[t]);return{selectors:{statusAdminReducer:n,getAllStatusesReducer:g,getAllStatusesGlobalReducer:e},actions:{getStatuses:S,getStatusesProject:p,upsertStatus:f,upsertStatusGlobal:u},state:{},hooks:{},functions:{}}}function N({}){const t=a.useMemo(i().Layouts.Sections.V1),n=a.useMemo(i().FormComponents.TextBox),e=a.useMemo(i().ButtonLoader),{selectors:{},actions:{upsertStatusGlobal:g}}=D(),{translate:S,getLabel:p}=_(),f=j(),[u,c]=a.useState({id:G()}),[h,T]=a.useState(!1);function A(){T(!0),g({...u,id:u.id}).then(o=>{T(!1),f.actions.closeDrawer()})}return P(d,{container:!0,children:[s(t,{title:"Status Details",style:{flexDirection:"column"},children:s(n,{label:S(p,"Token"),value:u.token,onChange:o=>c({...u,token:o.target.value.toUpperCase()}),field:"value",validation:[]})}),s(d,{style:{marginLeft:"1rem",marginBottom:"1rem"},children:s(e,{color:"primary",onClick:A,value:S(p,"Save"),variant:"outlined",isLoading:h})})]})}function $(t){const n=a.useMemo(i().Layouts.Groups.V1),e=a.useMemo(()=>F.byName("mapps-component-translate-component").component,[]),g=a.useMemo(i().FormComponents.TextBox),S=a.useMemo(i().FormComponents.Checkbox),p=a.useMemo(i().ButtonLoader),{getPlaceholder:f,getLabel:u,translate:c}=_(),{actions:h}=j(),[T,A]=a.useState(!1),[o,b]=a.useState(t.status.statusProject),{actions:{upsertStatus:C}}=D();function k(l,r){A(!0),C(o).then(m=>{A(!1),h.closeDrawer()})}function x(l){o.translation_id||(o.translation_id=G()),l.id||(l.id=o.translation_id),b({...o,translation:l})}return P(d,{container:!0,style:{display:"flex"},children:[s(d,{item:!0,xs:6,style:{display:"flex"},children:s(n,{title:"Status Translation",children:s(e,{translation:o.translation||{},setTranslate:x,i:!0})})}),s(d,{item:!0,xs:6,style:{display:"flex"},children:P(n,{title:"Status Details",children:[s(g,{onChange:l=>{b({...o,status_order:l.target.value})},placeholder:c(f,"Order"),isRequired:!0,label:c(u,"Status order"),value:o.status_order,field:"code",validation:[]}),s(S,{label:c(u,"Status is closing"),value:o.is_closed,onChange:l=>{b({...o,is_closed:l.target.checked})}})]})}),s(d,{style:{marginLeft:"1rem",marginBottom:"1rem"},children:s(p,{color:"primary",onClick:k,value:c(u,"Save"),variant:"outlined",isLoading:T})})]})}function Z(t){const[n,e]=a.useState(!0),g=a.useMemo(i().Layouts.Containers.V1),S=a.useMemo(i().Layouts.Table.V2),p=a.useMemo(i().ButtonLoader),{translate:f,getLabel:u}=_(),{actions:c}=j(),{selectors:{getAllStatusesGlobalReducer:h,getAllStatusesReducer:T},actions:{getStatuses:A,getStatusesProject:o,upsertStatus:b}}=D();a.useEffect(()=>{e(!0),Promise.all([o(),A()]).then(r=>{e(!1)})},[]);const C=a.useMemo(()=>h.sort((r,m)=>m.token<r.token?1:-1).map(r=>{const m=T.find(w=>w.status_id==r.id);return{...r,statusProject:m}}),[h,T]);function k(r,m){const w=G();e(!0),b({id:w,status_id:m.id,status:!0}).then(Q=>{e(!1)})}function x(){c.openDrawer(!0,s(d,{style:{width:"50vw",display:"flex"},children:s(N,{})}),"right")}function l(r,m){c.openDrawer(!0,s(d,{style:{width:"50vw",display:"flex"},children:s($,{status:m})}),"right")}return s(d,{container:!0,style:{justifyContent:"center"},children:s(g,{title:"Status List",icon:s(V,{}),xs:12,sm:12,children:s(S,{isLoading:n,title:"Manage Statuses",...q({}),freeActions:[s(p,{size:"small",value:f(u,"Add Status"),variant:"outlined",onClick:x,startIcon:s(I,{})},1)],pageSize:20,actions:[r=>({icon:B.Check,label:"Activate Status",onClick:k,hidden:r.statusProject}),r=>({icon:B.Edit,label:"Edit Status",onClick:l,hidden:!r.statusProject})],data:C})})})}export{Z as default};
