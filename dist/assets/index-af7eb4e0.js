import{u as A,R as o,M as x,d1 as H,j as e,F as S,g as y,db as T,df as Z,C as L,dg as de,v as B,G as d,m as ne,cZ as ce,d4 as j,d5 as $,d6 as X,dh as Q,d8 as oe,d3 as ue,d9 as pe}from"./index-b4b9f8f0.js";import{u as me}from"./hook-4371a1c0.js";import{u as D}from"./hook-be085d31.js";const ge=["!","|","&","=",">",">=","*","+","-","/","<=","<"];function _e({categoryOptionTemplate:g,setCategoryOptionTemplate:v,isSelection:n,isNumeric:s,isStrict:_,isDimReference:c}){const{translate:p,getLabel:r}=A(),l=o.useMemo(x().Layouts.Sections.V1),[a,t]=o.useState({...g});o.useEffect(()=>{v(a)},[a]);const{selectors:{dimensionsSelector:m}}=H();function u(f){const w=Object.keys(f).map(b=>f[b].label).join(" ");t({...a,func:w})}function i(){return[{id:null,value:null},...m.filter(f=>f.cott_id==(a.cott_id.id?a.cott_id.id:a.cott_id)).map(f=>({id:f.id,value:f.name}))]}function M(){return[{id:"",value:""},...m.filter(f=>f.as_cat_ref==!0).map(f=>({id:f.id,value:f.name}))]}return e(S,{children:y(l,{title:p(r,"Category Options Template Core"),children:[e(T,{label:p(r,"Token"),value:a.token,onChange:f=>t({...a,token:f.target.value}),field:"Name",validation:[]}),e(T,{noLabel:!0,label:p(r,"Option Value"),value:a.value,onChange:f=>t({...a,value:f.target.value}),field:"value",validation:[]}),!n()&&e(Z,{label:p(r,"Dimension referance value"),valueOptions:M(),value:a.dim_ref_id,onChange:f=>t({...a,dim_ref_id:f.target.value}),field:"type",validation:[]}),!n()&&e(Z,{label:p(r,"Dimension type"),valueOptions:i(),value:a.dim_id,onChange:f=>t({...a,dim_id:f.target.value}),field:"type",validation:[]}),!_()&&e(T,{label:p(r,"Order"),value:a.order,onChange:f=>t({...a,order:f.target.value}),field:"order",validation:[]}),!_()&&e(L,{label:p(r,"Active"),value:a.status,onChange:f=>t({...a,status:f.target.checked}),field:"order",validation:[]}),!c()&&!n()&&e(de,{id:"tagComponent",notUniq:!0,tags:a.func?a.func.split(" ").map(f=>({id:B(),value:B(),label:f})):[],label:"Function",onChange:u,suggestions:[...ge.map(f=>({value:f,label:f,type:"OPERATOR"})),,...m.map(f=>({id:B(),value:B(),label:`#$${f.name.trim()}#`,type:"PRIV"}))]})]})})}function he({categoryOptionTemplate:g,setCategoryOptionTemplate:v,isSelection:n,isNumeric:s,isDimReference:_}){const{translate:c,getLabel:p}=A(),r=o.useMemo(x().Layouts.Sections.V1),[l,a]=o.useState({...g});return o.useEffect(()=>{v(l)},[l]),y(S,{children:[s()&&y(r,{title:c(p,"Category numeric type flags"),children:[e(L,{label:c(p,"Allow Negative"),value:l.allow_negative,onChange:t=>a({...l,allow_negative:t.target.checked}),field:"is_required",validation:[]}),e(L,{label:c(p,"Allow Empty Formatting"),value:l.allow_empty_formatting,onChange:t=>a({...l,allow_empty_formatting:t.target.checked}),field:"allow_empty_formatting",validation:[]}),e(L,{label:c(p,"Allow Leading Zero"),value:l.allow_leading_zeros,onChange:t=>a({...l,allow_leading_zeros:t.target.checked}),field:"is_required",validation:[]}),y(d,{container:!0,children:[y(d,{container:!0,spacing:3,children:[e(d,{item:!0,xs:"6",children:e(T,{label:c(p,"Min"),value:l.min,onChange:t=>a({...l,min:t.target.value}),field:"min",validation:[]})}),e(d,{item:!0,xs:"6",children:e(T,{label:c(p,"Min Message Token"),value:l.min_message,onChange:t=>a({...l,min_message:t.target.value}),field:"min_message",validation:[]})})]}),y(d,{container:!0,spacing:3,children:[e(d,{item:!0,xs:"6",children:e(T,{label:c(p,"Max"),value:l.max,onChange:t=>a({...l,max:t.target.value}),field:"max",validation:[]})}),e(d,{item:!0,xs:"6",children:e(T,{label:c(p,"Max Message Token"),value:l.max_message,onChange:t=>a({...l,max_message:t.target.value}),field:"max_message",validation:[]})})]})]})]}),e(r,{title:c(p,"Category types with textfield"),children:y(d,{item:!0,xs:"12",children:[y(d,{container:!0,spacing:3,children:[e(d,{item:!0,xs:"6",children:e(L,{label:c(p,"Is Required"),value:l.is_required,onChange:t=>a({...l,is_required:t.target.checked}),field:"is_required",validation:[]})}),e(d,{item:!0,xs:"6",children:e(T,{label:c(p,"Is Required Message Token"),value:l.is_required_message,onChange:t=>a({...l,is_required_message:t.target.value}),field:"is_required_message",validation:[]})})]}),y(d,{container:!0,spacing:3,children:[e(d,{item:!0,xs:"6",children:e(T,{label:c(p,"Min Length"),value:l.min_length,onChange:t=>a({...l,min_length:t.target.value}),field:"min_length",validation:[]})}),e(d,{item:!0,xs:"6",children:e(T,{label:c(p,"Min Length Message Token"),value:l.min_length_message,onChange:t=>a({...l,min_length_message:t.target.value}),field:"min_length",validation:[]})})]}),y(d,{container:!0,spacing:3,children:[e(d,{item:!0,xs:"6",children:e(T,{label:c(p,"Max Length"),value:l.max_length,onChange:t=>a({...l,max_length:t.target.value}),field:"max_length",validation:[]})}),e(d,{item:!0,xs:"6",children:e(T,{label:c(p,"Max Length Message Token"),value:l.max_length_message,onChange:t=>a({...l,max_length_message:t.target.value}),field:"max_length",validation:[]})})]}),y(d,{container:!0,spacing:3,children:[e(d,{item:!0,xs:"6",children:e(T,{label:c(p,"Pattern"),value:l.pattern,onChange:t=>a({...l,pattern:t.target.value}),field:"pattern",validation:[]})}),e(d,{item:!0,xs:"6",children:e(T,{label:c(p,"Pattern Message Token"),value:l.pattern_message,onChange:t=>a({...l,pattern_message:t.target.value}),field:"pattern_length",validation:[]})})]})]})})]})}function fe({categoryOptionTemplate:g,setCategoryOptionTemplate:v}){const{translate:n,getLabel:s,getPlaceholder:_}=A(),c=o.useMemo(x().Layouts.Sections.V1),p=o.useMemo(()=>ne.byName("mapps-component-translate-component").component,[]),[r,l]=o.useState({...g});o.useEffect(()=>{v(r)},[r]);function a(t){r.value_translation_id||(r.value_translation_id=B()),t.id||(t.id=r.value_translation_id),l({...r,value_translation:t})}return e(S,{children:e(c,{title:n(s,"LANG_TEXTBOX"),children:e(p,{translation:r.value_translation||{},setTranslate:a})})})}function ve({categoryOptionTemplate:g,setCategoryOptionTemplate:v,isSelection:n,isNumeric:s}){const{translate:_,getLabel:c}=A(),p=o.useMemo(x().Layouts.Sections.V1),[r,l]=o.useState({...g});return o.useEffect(()=>{v(r)},[r]),y(S,{children:[y(p,{title:_(c,"Category Options Template CMS Common Flags"),children:[e(L,{label:_(c,"Allow to freetext search"),value:r.is_not_in_clob,onChange:a=>{l({...r,is_not_in_clob:a.target.checked})},field:"is_in_clob",validation:[]}),e(L,{label:_(c,"Is visible in view"),value:r.is_visible_view,onChange:a=>{l({...r,is_visible_view:a.target.checked})},field:"is_visible_view",validation:[]}),e(L,{label:_(c,"Is visible in form"),value:r.is_visible_form,onChange:a=>{l({...r,is_visible_form:a.target.checked})},field:"is_visible_form",validation:[]}),e(L,{label:_(c,"Is visible in search"),value:r.is_visible_search,onChange:a=>{l({...r,is_visible_search:a.target.checked})},field:"is_visible_search",validation:[]})]}),n()&&y(p,{title:_(c,"Category Select/Multiselect Flags"),children:[e(L,{label:_(c,"Is Prefix"),value:r.is_prefix,onChange:a=>l({...r,is_prefix:a.target.checked}),field:"is_prefix",validation:[]}),e(L,{label:_(c,"Is Suffix"),value:r.is_suffix,onChange:a=>l({...r,is_suffix:a.target.checked}),field:"is_suffix",validation:[]}),e(L,{label:_(c,"Is readonly"),value:r.is_readOnly,onChange:a=>{l({...r,is_readOnly:a.target.checked})},field:"is_visible_search",validation:[]}),e(L,{label:_(c,"Is DEFAULT"),value:r.is_default_value,onChange:a=>{l({...r,is_default_value:a.target.checked})},field:"is_default_value",validation:[]})]}),s()&&e(p,{title:_(c,"Category options template numeric type flags"),children:y(d,{container:!0,spacing:3,children:[e(d,{item:!0,xs:"4",children:e(T,{label:_(c,"Decimal Scale"),value:r.decimal_scale,onChange:a=>l({...r,decimal_scale:a.target.value}),field:"mask",validation:[]})}),e(d,{item:!0,xs:"4",children:e(T,{label:_(c,"DEFAULT VALUE"),value:r.default_value,onChange:a=>l({...r,default_value:a.target.value}),field:"default_value",validation:[]})}),e(d,{item:!0,xs:"4",children:e(T,{label:_(c,"INPUT FORMAT"),value:r.input_format,onChange:a=>l({...r,input_format:a.target.value}),field:"input_format",validation:[]})})]})}),!n()&&e(p,{title:_(c,"Category options template textfield type flags"),children:e(d,{item:!0,xs:"12",children:e(T,{label:_(c,"mask"),value:r.mask,onChange:a=>l({...r,mask:a.target.value}),field:"mask",validation:[]})})})]})}function ye({categoryOptionTemplate:g}){const{translate:v,getLabel:n}=A(),s=o.useMemo(x().Layouts.Sections.V1),[_,c]=o.useState({...g});return e(S,{children:y(s,{title:v(n,"Category Options Template Details"),children:[e(T,{label:v(n,"Id"),value:_.id,field:"Id",disabled:!0,validation:[]}),e(T,{label:v(n,"Order"),value:_.order,disabled:!0,field:"order",validation:[]}),e(T,{label:v(n,"Type"),value:_.cat_opt_type_template.type,disabled:!0,field:"type",validation:[]})]})})}const te=({catSingleOption:g,readOnly:v})=>{const[n,s]=o.useState(g),[_,c]=o.useState(!0),p=o.useMemo(x().Layouts.Tab.V1),r=o.useMemo(x().ButtonLoader),l=o.useMemo(x().BodyLoader),{translate:a,getLabel:t}=A(),{selectors:{getCategoryTypes:m},actions:{upsertCategoryOptionTemplate:u}}=D();o.useEffect(()=>{c(!0),setTimeout(()=>{s(g),c(!1)},500)},[g]);function i(){u(n)}function M(){return["SELECT","MULTISELECT"].includes(m.find(N=>N.id==n.cat_opt_type_template.cot_id).type)}function f(){return["float","int"].includes(n.cat_opt_type_template.type)}function w(){return m.find(N=>N.id==n.cat_opt_type_template.cot_id).is_strict}function b(){return n.dim_ref_id}return!v&&_?e(d,{style:{height:"400px",display:"flex"},children:e(l,{text:" ",size:"25px"})}):!_&&y(d,{container:!0,children:[e(p,{defaultTab:0,tabConfig:[{label:"Core",render:()=>e(_e,{categoryOptionTemplate:n,setCategoryOptionTemplate:s,isSelection:M,isDimReference:b,isNumeric:f,isStrict:w})},!b()&&!M()&&{label:"Validation",render:()=>e(he,{categoryOptionTemplate:n,setCategoryOptionTemplate:s,isSelection:M,isDimReference:b,isNumeric:f})},!b()&&{label:"CMS Flags",render:()=>e(ve,{categoryOptionTemplate:n,setCategoryOptionTemplate:s,isSelection:M,isDimReference:b,isNumeric:f})},!b()&&{label:"Translate",render:()=>e(fe,{categoryOptionTemplate:n,setCategoryOptionTemplate:s,isSelection:M,isDimReference:b,isNumeric:f})},{label:"Details",render:()=>e(ye,{categoryOptionTemplate:n,setCategoryOptionTemplate:s,isSelection:M,isDimReference:b,isNumeric:f})}]}),!v&&e(r,{color:"primary",onClick:i,value:a(t,"Save"),variant:"outlined"})]})};function ae({catOptionId:g,readOnly:v}){const{translate:n,getLabel:s}=A(),{selectors:{getCategoryOptionsById:_},hooks:{setCategoryOptionId:c},functions:{isLoaded:p},actions:{upsertCategoryOptionTemplate:r}}=D(),{actions:l}=ce(),a=o.useMemo(x().Layouts.Sections.V1),t=o.useMemo(x().ButtonLoader),[m,u]=o.useState(),[i,M]=o.useState();o.useEffect(()=>{c(g)},[g]),o.useEffect(()=>{M(_)},[_]);const f=o.useMemo(()=>{var O;const h=(O=i==null?void 0:i.cat_opt_temp)==null?void 0:O.find(F=>F.id==m);return m&&h?e(te,{catSingleOption:h}):e(d,{})},[m,i]);function w(h){const O=i.cat_opt_temp.find(F=>F.id==h.currentTarget.dataset.key);O&&l.openDrawer(!0,e(d,{style:{width:"50vw",display:"flex"},children:e(te,{readOnly:!0,catSingleOption:O})}))}function b(h){if(v)w(h);else{const O=i.cat_opt_temp.find(F=>F.id==h.currentTarget.dataset.key);u(O.id)}}function N(h){if(v)return;const O=B(),F=i.cat_opt.cat_options_type_temp.find(J=>J.id==h.currentTarget.dataset.tag),Y=B();r({co_id:i.id,id:O,cott_id:h.currentTarget.dataset.tag,order:F.order,status:1,value_translation_id:Y,value_translation:{id:Y}}),u(O)}function P(h){const O=B(),F=i.cat_opt.cat_options_type_temp[0],Y=B();r({co_id:i.id,id:O,cott_id:F.id,order:-1,status:0,value_translation_id:Y,value_translation:{id:Y}}),u(O)}return p(g)&&i?p(g)&&i&&y(d,{container:!0,style:{flexFlow:"row",gap:"1rem"},children:[y(d,{container:!0,style:{flexDirection:"column"},sm:v?12:2,xs:12,children:[i.cat_opt&&i.cat_opt.is_strict&&e(a,{title:n(s,"Category Option Templates Strict"),children:e(j,{className:"mapps-io-list-link",style:{width:"100%"},children:i.cat_opt&&i.cat_opt.is_strict&&i.cat_opt.cat_options_type_temp.sort((h,O)=>Number(h.order)>Number(O.order)?1:-1).map(h=>{const O=i.cat_opt_temp.find(F=>F.cott_id==h.id)||{};return e(d,{className:"mapps-io-list-item",children:e($,{"data-tag":h.id,button:!0,"data-key":O.id,onClick:O.id?b:N,className:O.id?m==O.id&&"selected":"primary",children:e(X,{children:O.token||O.value||h.order})})},h.id)})})}),i.cat_opt&&!i.cat_opt.is_strict&&e(a,{title:n(s,"Category Option Templates Not Strict"),children:y(S,{children:[e(j,{className:"mapps-io-list-link",style:{width:"100%"},children:i.cat_opt_temp.filter(h=>h.status==1).sort((h,O)=>Number(h.order)>Number(O.order)?1:-1).map(h=>e(d,{className:"mapps-io-list-item",children:e($,{"data-tag":h.cott_id,button:!0,"data-key":h.id,onClick:h.id?b:N,className:h.id?m==h.id&&"selected":"primary",children:e(X,{children:h.token||h.value||h.order})})},h.id))}),!v&&e(t,{color:"primary",onClick:P,value:n(s,"Create new template"),variant:"outlined"})]})}),!v&&i.cat_opt&&!i.cat_opt.is_strict&&i.cat_opt_temp.find(h=>h.status==0)&&e(a,{title:n(s,"Category Option Templates Not Active"),children:e(S,{children:e(j,{className:"mapps-io-list-link",style:{width:"100%"},children:i.cat_opt_temp.filter(h=>h.status==0).sort((h,O)=>Number(h.order)>Number(O.order)?1:-1).map(h=>e(d,{className:"mapps-io-list-item",children:e($,{"data-tag":h.cott_id,button:!0,"data-key":h.id,onClick:h.id?b:N,className:h.id?m==h.id&&"selected":"primary",children:e(X,{children:h.token||h.value||h.order})})},h.id))})})})]}),!v&&e(a,{title:n(s,"Category Option Templates"),sm:10,xs:12,children:e(d,{container:!0,spacing:"3",style:{flexDirection:"column"},children:f})})]}):e(S,{})}function Ce({catOptionId:g}){const{translate:v,getLabel:n}=A(),s=o.useMemo(x().ButtonLoader),_=o.useMemo(x().Layouts.Tab.V1),{selectors:{getCategoryOptionsById:c},actions:{upsertCategoryOptions:p},hooks:{setCategoryOptionId:r},functions:{isLoaded:l}}=D(),[a,t]=o.useState();if(o.useEffect(()=>{r(g)},[g]),o.useEffect(()=>{t(c)},[c]),!(l(g)&&a))return e(S,{});function m(u){p(a)}return l(g)&&a&&y(d,{container:!0,children:[e(_,{defaultTab:0,tabConfig:[{label:"Search",render:()=>e(Q,{mode:"json",theme:"monokai",value:a.search_params,onChange:u=>{t({...a,search_params:u})},padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,width:"100%",height:"80vh"},showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,setOptions:{enableBasicAutocompletion:!1,enableLiveAutocompletion:!1,enableSnippets:!1,showLineNumbers:!0,tabSize:2}},1)},{label:"Create",render:()=>e(S,{children:e(Q,{mode:"json",theme:"monokai",value:a.create_params,onChange:u=>{t({...a,create_params:u})},padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,width:"100%",height:"80vh"},showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,setOptions:{enableBasicAutocompletion:!1,enableLiveAutocompletion:!1,enableSnippets:!1,showLineNumbers:!0,tabSize:2}},2)})},{label:"Preview",render:()=>e(S,{children:e(Q,{mode:"json",theme:"monokai",value:a.preview_params,onChange:u=>{t({...a,preview_params:u})},padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,width:"100%",height:"80vh"},showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,setOptions:{enableBasicAutocompletion:!1,enableLiveAutocompletion:!1,enableSnippets:!1,showLineNumbers:!0,tabSize:2}},3)})}]}),e(s,{color:"primary",onClick:m,value:v(n,"Save"),variant:"outlined"})]})}function be({catOptionId:g,isImage:v}){const{translate:n,getLabel:s}=A(),_=o.useMemo(x().ButtonLoader),{selectors:{getCategoryOptionsById:c},actions:{upsertCategoryOptions:p},hooks:{setCategoryOptionId:r},functions:{isLoaded:l}}=D(),a=o.useMemo(x().Layouts.Sections.V1),[t,m]=o.useState();o.useEffect(()=>{r(g)},[g]),o.useEffect(()=>{m(c)},[c]);function u(i){p(t)}return l(g)&&t?l(g)&&t&&y(S,{children:[v()&&e(a,{title:"Limitations settings",children:e(d,{container:!0,spacing:3,children:e(T,{label:n(s,"Limit of"),value:t.limit_of,onChange:i=>{m({...t,limit_of:i.target.value})},field:"name",validation:[]})})}),y(a,{title:"Search settings",children:[e(T,{label:n(s,"Order search"),value:t.order_search,onChange:i=>{m({...t,order_search:i.target.value})},field:"order",validation:[]}),e(L,{label:n(s,"Is searchable"),value:t.is_searchable,onChange:i=>{m({...t,is_searchable:i.target.checked})},field:"is_searchable",validation:[]}),e(L,{label:n(s,"Show above pin on map"),value:t.is_on_pin_map,onChange:i=>{m({...t,is_on_pin_map:i.target.checked})},field:"is_on_pin_map",validation:[]}),e(L,{label:n(s,"Can above pin (search)"),value:t.can_above_pin,onChange:i=>{m({...t,can_above_pin:i.target.checked})},field:"is_visible_view",validation:[]}),e(L,{label:n(s,"Treat as url params"),value:t.is_params,onChange:i=>{m({...t,is_params:i.target.checked})},field:"is_form_hidden",validation:[]}),e(L,{label:n(s,"On main page search"),value:t.is_on_main_page,onChange:i=>{m({...t,is_on_main_page:i.target.checked})},field:"is_visible_view",validation:[]})," "]}),y(a,{title:"Create settings",children:[e(T,{label:n(s,"Order label"),value:t.order,onChange:i=>{m({...t,order:i.target.value})},field:"order",validation:[]}),e(L,{label:n(s,"Is require"),value:t.is_require,onChange:i=>{m({...t,is_require:i.target.checked})},field:"is_require",validation:[]}),e(L,{label:n(s,"Is  on form rendered"),value:t.is_form_rendered,onChange:i=>{m({...t,is_form_rendered:i.target.checked})},field:"is_form_rendered",validation:[]}),e(L,{label:n(s,"Is in form hidden"),value:t.is_form_hidden,onChange:i=>{m({...t,is_form_hidden:i.target.checked})},field:"is_form_hidden",validation:[]})]}),y(a,{title:"Preview settings",children:[e(L,{label:n(s,"Is on map list"),value:t.is_on_map,onChange:i=>{m({...t,is_on_map:i.target.checked})},field:"is_on_map",validation:[]}),e(L,{label:n(s,"Is visible in preview"),value:t.is_visible_view,onChange:i=>{m({...t,is_visible_view:i.target.checked})},field:"is_visible_view",validation:[]})]}),y(a,{title:"IUA settings",children:[e(L,{label:n(s,"On IUA view"),value:t.is_on_iua,onChange:i=>{m({...t,is_on_iua:i.target.checked})},field:"is_visible_view",validation:[]}),e(L,{label:n(s,"Init on IUA request"),value:t.is_on_iua_request,onChange:i=>{m({...t,is_on_iua_request:i.target.checked})},field:"is_on_pin_map",validation:[]})]}),e(_,{color:"primary",onClick:u,value:n(s,"Save"),variant:"outlined"})]}):e(S,{})}function ie({catOptionId:g,readOnly:v}){const{translate:n,getLabel:s}=A(),_=o.useMemo(x().Layouts.Sections.V1),c=o.useMemo(x().ButtonLoader),{selectors:{getCategoryOptionsById:p,getCategoryTypes:r},actions:{upsertCategoryOptions:l},hooks:{setCategoryOptionId:a},functions:{isLoaded:t}}=D(),{selectors:{dimensionsSelector:m}}=H(),[u,i]=o.useState();o.useEffect(()=>{a(g)},[g]),o.useEffect(()=>{i(p)},[p]);function M(){return[{id:null,value:null},...m.filter(b=>b.co_type_id==u.cot_id&&b.cott_id==null).map(b=>({id:b.id,value:b.name}))]}function f(){const b=Array.isArray(r)?r.map(N=>({id:N.id,value:N.name,type:N.type})):[];return[{id:void 0,value:"",type:void 0},...b]}function w(b){l(u)}return t(g)&&u?t(g)&&u&&y(S,{children:[y(_,{title:n(s,"Core"),children:[v&&y(d,{item:!0,xs:"12",children:[e(T,{label:n(s,"Id"),value:u.id,onChange:b=>{i({...u,name:b.target.value})},disabled:!0,field:"name",validation:[]}),u.lang]}),y(d,{item:!0,xs:"12",children:[e(T,{label:n(s,"Name"),value:u.name,onChange:b=>{i({...u,name:b.target.value})},disabled:v,field:"name",validation:[]}),u.lang]}),e(Z,{disabled:u.cot_id,isRequired:!0,value:u&&u.cot_id,label:n(s,"CATEGORY_TEMP_OPTION_TYPE_LABEL"),valueOptions:f(),field:"type"}),e(d,{item:!0,xs:"12",children:e(Z,{disabled:v,label:n(s,"Dimension"),valueOptions:M(),value:u.dim_id,onChange:b=>{i({...u,dim_id:b.target.value.length>0?b.target.value:null})},field:"type",validation:[]})}),e(d,{item:!0,xs:"12",children:e(L,{disabled:v,label:n(s,"Active"),value:u.status,onChange:b=>i({...u,status:b.target.checked}),field:"status",validation:[]})})]}),!v&&e(S,{children:e(c,{color:"primary",onClick:w,value:n(s,"Save"),variant:"outlined"})})]}):e(S,{})}function Te({catOptionId:g}){const{translate:v,getLabel:n}=A(),{selectors:{getCategoryOptionsById:s},actions:{upsertCategoryOptions:_},hooks:{setCategoryOptionId:c},functions:{isLoaded:p}}=D(),r=o.useMemo(()=>ne.byName("mapps-component-translate-component").component,[]),l=o.useMemo(x().Layouts.Sections.V1),a=o.useMemo(x().ButtonLoader),[t,m]=o.useState();o.useEffect(()=>{c(g)},[g]),o.useEffect(()=>{m(s)},[s]);function u(M){m({...t,translation:M})}function i(M){t.translation_id||(t.translation_id=B()),t.translation.id=t.translation_id,_(t)}return p(g)&&t?p(g)&&t&&y(S,{children:[e(l,{title:v(n,"LANG_TEXTBOX"),children:e(r,{translation:t.translation||{},setTranslate:u})}),e(a,{color:"primary",onClick:i,value:v(n,"Save"),variant:"outlined"})]}):e(S,{})}function ke({catOptionId:g,isMultiselection:v}){const{translate:n,getLabel:s}=A(),{selectors:{getCategoryOptionsById:_},hooks:{setCategoryOptionId:c},actions:{upsertCategoryOptions:p},functions:{isLoaded:r}}=D(),l=o.useMemo(x().Layouts.Sections.V1),a=o.useMemo(x().ButtonLoader),[t,m]=o.useState();o.useEffect(()=>{c(g)},[g]),o.useEffect(()=>{m(_)},[_]);function u(i){p(t)}return r(g)&&t?r(g)&&t&&y(S,{children:[y(l,{title:n(s,"Select Limitation"),children:[y(d,{container:!0,spacing:3,children:[e(d,{item:!0,xs:"12",sm:"5",children:e(L,{label:n(s,"Is Required"),value:t.is_required,onChange:i=>{m({catOption:t,is_required:i.target.checked})},field:"is_required",validation:[]})}),e(d,{item:!0,xs:"12",sm:"7",children:e(T,{label:n(s,"Is Required Message"),value:t.is_required_message,onChange:i=>{m({catOption:t,is_required_message:i.target.value})},field:"is_required_message",validation:[]})})]}),v()&&y(S,{children:[y(d,{container:!0,spacing:3,children:[e(d,{item:!0,xs:"12",sm:"5",children:e(T,{label:n(s,"Min Selected"),value:t.min_selected,onChange:i=>{m({catOption:t,min_selected:i.target.value})},field:"min_selected",validation:[]})}),e(d,{item:!0,xs:"12",sm:"7",children:e(T,{label:n(s,"Min Selected Message"),value:t.min_selected_message,onChange:i=>{m({catOption:t,min_selected_message:i.target.value})},field:"min_selected_message",validation:[]})})]}),y(d,{container:!0,spacing:3,children:[e(d,{item:!0,xs:"12",sm:"5",children:e(T,{label:n(s,"Max Selected"),value:t.max_selected,onChange:i=>{m({catOption:t,max_selected:i.target.value})},field:"max_selected",validation:[]})}),e(d,{item:!0,xs:"12",sm:"7",children:e(T,{label:n(s,"Max  Selected Message"),value:t.max_selected_message,onChange:i=>{m({catOption:t,max_selected_message:i.target.value})},field:"max_selected_message",validation:[]})})]})]})]}),e(a,{color:"primary",onClick:u,value:n(s,"Save"),variant:"outlined"})]}):e(S,{})}function Oe({catOptionId:g,readOnly:v}){const{translate:n,getLabel:s}=A(),_=o.useMemo(x().Layouts.Sections.V1),c=o.useMemo(x().ButtonLoader),p=oe(),{selectors:{getCategoryOptionsById:r,getCategoryTypes:l},actions:{upsertCategoryOptions:a},hooks:{setCategoryOptionId:t},functions:{isLoaded:m}}=D();H();const[u,i]=o.useState({id:B()});function M(){const w=Array.isArray(l)?l.map(b=>({id:b.id,value:b.name,type:b.type})):[];return[{id:void 0,value:"",type:void 0},...w]}function f(w){u.translation_id=B(),u.translation={id:u.translation_id},a(u).then(b=>{p(`/mapps/categories/categoriesOptions?catOptionId=${u.id}`)})}return e(S,{children:y(_,{title:n(s,"Create new Category Option"),children:[e(Z,{value:u.cot_id,label:n(s,"CATEGORY_TEMP_OPTION_TYPE_LABEL"),valueOptions:M(),onChange:w=>{i({...u,cot_id:w.target.value})},field:"type"}),y(d,{item:!0,xs:"12",children:[e(T,{label:n(s,"Name"),value:u.name,onChange:w=>{i({...u,name:w.target.value})},disabled:v,field:"name",validation:[]}),u.lang]}),e(c,{color:"primary",onClick:f,value:n(s,"Create"),variant:"outlined"})]})})}function xe({catOptionId:g}){var ee;const{translate:v,getLabel:n}=A(),s=o.useMemo(x().Layouts.Sections.V1),_=o.useMemo(x().Layouts.Groups.V1);o.useMemo(x().ButtonLoader);const{selectors:{getCategoryOptionsById:c,getAllCategoryOptionsReducer:p},hooks:{setCategoryOptionId:r},functions:{isLoaded:l}}=D(),{selectors:{dimensionsSelector:a}}=H(),t=oe(),{lang:m}=ue(),[u,i]=o.useState(),[M,f]=o.useState([]),[w,b]=o.useState([]),[N,P]=o.useState([]),[h,O]=o.useState([]);o.useEffect(()=>{r(g)},[g]),o.useEffect(()=>{i(c),c&&F(c,p)},[c]);function F(C,k){le(C,k),se(C,k),J(C,k),Y(C,k)}function Y(C,k){var G;const R=(G=C==null?void 0:C.cat_opt_temp)==null?void 0:G.filter(E=>E.func).map(E=>({func:E.func,dim:E.func.match(/#\$\w*#/g)?E.func.match(/#\$\w*#/g).map(V=>a.find(I=>I.name==V.replace("#$","").replace("#",""))):[]})),U=R==null?void 0:R.map(E=>({func:E.func,relation:k==null?void 0:k.filter(V=>{var I,q;return((I=E.dim)==null?void 0:I.map(z=>z.id).includes(V.dim_id))||((q=V.cat_opt_temp)==null?void 0:q.find(z=>E.dim.map(W=>W.id).includes(z.dim_id)))})}));U&&O([...U])}function J(C,k){const R=C.dim_id,U=a.filter(I=>I.id==R).map(I=>I.name),G=a==null?void 0:a.filter(I=>{var q;return(q=C==null?void 0:C.cat_opt_temp)==null?void 0:q.map(z=>z.dim_id).includes(I.id)}).filter(I=>I).map(I=>I.name),V=[...U,...G].map(I=>({name:I,relation:k==null?void 0:k.map(q=>{var z;if(((z=q.cat_opt_temp)==null?void 0:z.filter(W=>W.func).filter(W=>W.func.includes(`#$${I}#`)).length)>0)return q}).filter(q=>q)}));V&&P([...V])}function le(C,k){const R=C.dim_id,U=k==null?void 0:k.filter(G=>{var E;return(E=G.cat_opt_temp)==null?void 0:E.find(V=>V.dim_ref_id==R&&V.dim_ref_id)});U&&f([...U])}function se(C,k){const R=k==null?void 0:k.filter(U=>{var G;return(G=C==null?void 0:C.cat_opt_temp)==null?void 0:G.filter(E=>E.dim_ref_id).map(E=>E.dim_ref_id).includes(U.dim_id)});R&&b([...R])}function re(C){t("/mapps/categories/categories/edit/"+C.currentTarget.dataset.key)}function K(C){t("/mapps/categories/categoriesOptions?catOptionId="+C.currentTarget.dataset.key)}return l(g)&&u?l(g)&&u&&y(S,{children:[e(_,{container:!0,style:{flexFlow:"row",gap:"1rem"},title:"Category Relations by Key",children:y(d,{container:!0,spacing:3,children:[e(d,{item:!0,xs:4,sm:4,children:e(s,{title:v(n,"Linked Categories"),children:e(j,{className:"mapps-io-list-link",style:{width:"100%"},children:(ee=u==null?void 0:u.category_link)==null?void 0:ee.map((C,k)=>e(d,{className:"mapps-io-list-item",children:e($,{"data-key":C.category_id,button:!0,onClick:re,children:e(X,{children:C.category["category_"+m]})})},C.category_id))})})}),e(d,{item:!0,xs:4,sm:4,children:e(s,{title:v(n,"This Category Option is linked as Related Dim"),children:e(j,{className:"mapps-io-list-link",style:{width:"100%"},children:M.map(C=>e(d,{className:"mapps-io-list-item",children:e($,{"data-key":C.id,button:!0,onClick:K,children:e(X,{children:C.name})})},C.id))})})}),e(d,{item:!0,xs:4,sm:4,children:e(s,{title:v(n,"This Category Option use other Category Options"),children:e(j,{className:"mapps-io-list-link",style:{width:"100%"},children:w.map(C=>e(d,{className:"mapps-io-list-item",children:e($,{"data-key":C.id,button:!0,onClick:K,children:e(X,{children:C.name})})},C.id))})})})]})}),e(_,{container:!0,style:{flexFlow:"row",gap:"1rem"},title:"This Category Option is used in other category option function",children:e(d,{container:!0,spacing:3,children:N.map(C=>{if(C.relation.length>0)return e(d,{item:!0,xs:4,sm:4,children:e(s,{title:v(n,`[${C.name}] `),children:e(j,{className:"mapps-io-list-link",style:{width:"100%"},children:C.relation.map(k=>e(d,{className:"mapps-io-list-item",children:e($,{"data-key":k.id,button:!0,onClick:K,children:e(X,{children:k.name})})},k.id))})})})})})}),e(_,{container:!0,style:{flexFlow:"row",gap:"1rem"},title:"Category Options Related by this Category Option Functions",children:e(d,{container:!0,spacing:3,children:h.map(C=>{if(C.relation.length>0)return e(d,{item:!0,xs:4,sm:4,children:e(s,{title:v(n,`[${C.func}]`),children:e(j,{className:"mapps-io-list-link",style:{width:"100%"},children:C.relation.map(k=>e(d,{className:"mapps-io-list-item",children:e($,{"data-key":k.id,button:!0,onClick:K,children:e(X,{children:k.name})})},k.id))})})})})})})]}):e(S,{})}function Le({categoryOptionId:g}){const{functions:{setTitle:v}}=me(),n=o.useMemo(x().Layouts.Groups.V1),s=o.useMemo(x().Layouts.Tab.V1),_=o.useMemo(x().BodyLoader),{hooks:{setCategoryOptionId:c},selectors:{getCategoryOptionsById:p,getCategoryTypes:r}}=D(),l=pe(),[a,t]=o.useState(),[m,u]=o.useState(),i=o.useMemo(()=>new URLSearchParams(l.search).get("catOptionId")||g,[l.search,g]),[M,f]=o.useState(!1);o.useEffect(()=>{v("Category Option")},[]),o.useEffect(()=>{u(p)},[p]),o.useEffect(()=>{f(!0),i=="new"?u({}):(c(i),t(i)),setTimeout(()=>{f(!1)},500)},[i]);function w(){return["SELECT","MULTISELECT"].includes(r.find(P=>P.id==m.cot_id).type)}function b(){return["MULTISELECT"].includes(r.find(P=>P.id==m.cot_id).type)}function N(){return["IMAGES"].includes(r.find(P=>P.id==m.cot_id).type)}return M||!m?e(d,{style:{height:"400px",display:"flex"},children:e(_,{text:" ",size:"25px"})}):!M&&m&&y(d,{container:!0,children:[!a&&e(S,{children:e(n,{title:"Create Category Option",children:e(Oe,{})})}),a&&y(S,{children:[" ",y(d,{container:!0,style:{flexFlow:"row"},children:[e(n,{xs:12,sm:6,title:"Category Option Detail",children:e(ie,{catOptionId:a,readOnly:!0})}),e(n,{title:"Category Option Templates",xs:12,sm:6,children:e(ae,{catOptionId:a,readOnly:!0})})]}),e(s,{defaultTab:0,tabConfig:[{label:"Core",render:()=>e(ie,{catOptionId:a})},{label:"Translation",render:()=>e(Te,{catOptionId:a})},w()&&{label:"Validation",render:()=>e(ke,{catOptionId:a,isMultiselection:b})},{label:"CMS Flags",render:()=>e(be,{catOptionId:a,isImage:N})},{label:"CMS",render:()=>e(Ce,{catOptionId:a})},{label:"Category Options Items",render:()=>e(ae,{catOptionId:a})},{label:"Relations",render:()=>e(xe,{catOptionId:a})}]})]})]})}const Ee=Object.freeze(Object.defineProperty({__proto__:null,default:Le},Symbol.toStringTag,{value:"Module"}));export{Le as C,ie as a,Ee as i};
