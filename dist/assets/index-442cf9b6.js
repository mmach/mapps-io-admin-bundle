import{R as o,t as _,f as j,cZ as E,dj as R,M as m,eh as x,u as P,j as e,G as i,T as u,ei as U,ej as V,ek as B,g as l,el as h}from"./index-b4b9f8f0.js";function G(d){const[p,f]=o.useState(!0),[r,g]=o.useState(new Date),[v,I]=o.useState([]),b=_({}),y=j(),w=E(),S=R(),A=o.useMemo(m().Layouts.Table.V2),O=o.useMemo(m().IUA.PREVIEW.DEFAULT),s=x(),{translate:D,getLabel:F}=P();o.useEffect(()=>()=>s.actions.clean(),[]),o.useEffect(()=>{f(!0),s.actions.getInvoices({year:r.getFullYear(),month:r.getMonth(),asAdmin:!0}).then(t=>{const n=t.data.filter(a=>!b.selectors.iuaReducer.iuaRelations[a.iua.id]).map(a=>a.iua.id);if(f(!1),n.length>0)return b.actions.getIuaList(n)}).then(t=>{if(t&&t.data){const n=[...new Set(t.data.map(a=>a.category_id))];S.hooks.setCategoryIds(n)}})},[r]),o.useEffect(()=>{I([...s.selectors.invoicesAdminReducer.invoices]),console.log(s.selectors.invoicesAdminReducer.invoices)},[s.selectors.invoicesAdminReducer.invoices]);function M(t){const n=t;window.scrollTo(0,0),g(n)}function C(t,n){w.actions.openDrawer(!0,e(i,{container:!0,style:{width:1100},children:e(O,{iua_id:n.iua.id,cmsMode:"DEFAULT",device:"desktop"})}),"right")}function L(t,n){const a=n.id,c=v.filter(T=>T.id==a)[0],k={pdf_id:c.blob.blob_id,subject:D(F,"SEND_MAIL_SUBJECT",c.number_string,c.month+"/"+c.year),body:`${window.env.BLOB_URL}/blob/${c.blob.blob_id}.pdf`};y.actions.openModal(!0,e(B,{...k}))}return e(i,{container:!0,style:{justifyContent:"center"},children:e(A,{isLoading:p,icons:u,freeActions:[e(U,{variant:"month",label:"Month",dateFormat:"MM/yyyy",showMonthYearPicker:!0,value:r,onChange:M})],...V({}),actions:[t=>({icon:u.OpenIn,label:"Open IUA",onClick:C}),t=>({icon:u.PictureAsPdf,label:"Open Invoice",onClick:L})],data:v.sort((t,n)=>new Date(n.createdAt)>new Date(t.createdAt)).map(t=>({...t,info:{number:t.number}})),title:"Invoices List"})})}function $(){const d=o.useMemo(m().Layouts.Containers.V1);return l(i,{container:!0,style:{justifyContent:"center"},children:[l(d,{title:"TODOOOO",icon:e(h,{}),xs:12,sm:12,children:["TODOOOOOOs",l(i,{children:["Income/Outcome types,",e("br",{}),"Fill auto get incoide or manual invoice flag,",e("br",{}),"Allow to gen manual invoice,",e("br",{}),"Allow edit only manual invoice,",e("br",{}),"link income / outcome invoices,",e("br",{}),"Snapshot for user invoice information values",e("br",{}),"FIX backend to gen invoice based on inputs",e("br",{}),"Socket for invoice status change",e("br",{})]}),e(i,{children:"Income - include fees and tax, Outcome - price with tax"}),e(i,{children:"Calculate summary income for all fees"})]}),e(d,{title:"Invoices",icon:e(h,{}),xs:12,sm:12,children:e(G,{})})]})}export{$ as default};
